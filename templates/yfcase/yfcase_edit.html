{% load widget_tweaks %}
<style type="text/css">
.help-block {
	color: red;
}
</style>
<!-- 程式主題的部份 -->
<form action="{% url 'yfcase:yfcase_edit' yfcase.id %}" method="post" id="yfcaseUpdateForm" data-townships-url="{% url 'yfcase:ajax_load_townships' %}" novalidate>{% csrf_token %}
	<div class="modal-dialog">
		<div class="modal-content">
			<!-- header -->
			<div class="modal-header">
				<h5 class="modal-title" id="exampleModalLabel">{{title}}</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<!-- body -->
			<div class="modal-body">

				<input type="hidden" id="user" name="user" value={{author_id}}>
				
				        <!--案號-->
        <div class="form-group">
          <label for="{{ form.yfcaseCaseNumber.id_for_label }}">
            {{ form.yfcaseCaseNumber.label }}
          </label>
          {{ form.yfcaseCaseNumber|add_class:'form-control' }}
          <span class="help-block">{{ form.yfcaseCaseNumber.error }}</span>
        </div>
        
        <!--公司-->
        <div class="form-group">
          <label for="{{ form.yfcaseCompany.id_for_label }}">
            {{ form.yfcaseCompany.label }}
          </label>
          {{ form.yfcaseCompany|add_class:'form-control' }}
          <span class="help-block">{{ form.yfcaseCompany.error }}</span>
        </div>
        
        <!--城市里-->
        <div class="form-group">
          <label for="{{ form.yfcaseCity.id_for_label }}">
            {{ form.yfcaseCity.label }}
            </label>
          {{ form.yfcaseCity|add_class:'form-control' }}
          <span class="help-block">{{ form.yfcaseCity.error }}</span>
        </div>
        
        <!--鄉鎮區里-->
        <div class="form-group">
          <label for="{{ form.yfcaseTownship.id_for_label }}">
            {{ form.yfcaseTownship.label }}
            </label>
          {{ form.yfcaseTownship|add_class:'form-control' }}
          <span class="help-block">{{ form.yfcaseTownship.error }}</span>
        </div>
        
        <!--段號-->
        <div class="form-group">
          <label for="{{ form.yfcaseBigSection.id_for_label }}">
            {{ form.yfcaseBigSection.label }}
            </label>
          {{ form.yfcaseBigSection|add_class:'form-control' }}
          <span class="help-block">{{ form.yfcaseBigSection.error }}</span>
        </div>
        
        <!--小段-->
        <div class="form-group">
          <label for="{{ form.yfcaseSmallSection.id_for_label }}">
            {{ form.yfcaseSmallSection.label }}
            </label>
          {{ form.yfcaseSmallSection|add_class:'form-control' }}
          <span class="help-block">{{ form.yfcaseSmallSection.error }}</span>
        </div>
        
        <!--村里-->
        <div class="form-group">
          <label for="{{ form.yfcaseVillage.id_for_label }}">
            {{ form.yfcaseVillage.label }}
            </label>
          {{ form.yfcaseVillage|add_class:'form-control' }}
          <span class="help-block">{{ form.yfcaseVillage.error }}</span>
        </div>
        
        <!--鄰-->
        <div class="form-group">
          <label for="{{ form.yfcaseNeighbor.id_for_label }}">
            {{ form.yfcaseNeighbor.label }}
            </label>
          {{ form.yfcaseNeighbor|add_class:'form-control' }}
          <span class="help-block">{{ form.yfcaseNeighbor.error }}</span>
        </div>
        
        <!--街路-->
        <div class="form-group">
          <label for="{{ form.yfcaseStreet.id_for_label }}">
            {{ form.yfcaseStreet.label }}
            </label>
          {{ form.yfcaseStreet|add_class:'form-control' }}
          <span class="help-block">{{ form.yfcaseStreet.error }}</span>
        </div>
        
        <!--段-->
        <div class="form-group">
          <label for="{{ form.yfcaseSection.id_for_label }}">
            {{ form.yfcaseSection.label }}
            </label>
          {{ form.yfcaseSection|add_class:'form-control' }}
          <span class="help-block">{{ form.yfcaseSection.error }}</span>
        </div>
        
        <!--巷-->
        <div class="form-group">
          <label for="{{ form.yfcaseLane.id_for_label }}">
            {{ form.yfcaseLane.label }}
            </label>
          {{ form.yfcaseLane|add_class:'form-control' }}
          <span class="help-block">{{ form.yfcaseLane.error }}</span>
        </div>
        
        <!--弄-->
        <div class="form-group">
          <label for="{{ form.yfcaseAlley.id_for_label }}">
            {{ form.yfcaseAlley.label }}
            </label>
          {{ form.yfcaseAlley|add_class:'form-control' }}
          <span class="help-block">{{ form.yfcaseAlley.error }}</span>
        </div>
        
        <!--號-->
        <div class="form-group">
          <label for="{{ form.yfcaseNumber.id_for_label }}">
            {{ form.yfcaseNumber.label }}
            </label>
          {{ form.yfcaseNumber|add_class:'form-control' }}
          <span class="help-block">{{ form.yfcaseNumber.error }}</span>
        </div>
        
        <!--樓-->
        <div class="form-group">
          <label for="{{ form.yfcaseFloor.id_for_label }}">
            {{ form.yfcaseFloor.label }}
            </label>
          {{ form.yfcaseFloor|add_class:'form-control' }}
          <span class="help-block">{{ form.yfcaseFloor.error }}</span>
        </div>
        
        <!--債務人-->
        <div class="form-group">
          <label for="{{ form.yfcaseDebtor.id_for_label }}">
            {{ form.yfcaseDebtor.label }}
            </label>
          {{ form.yfcaseDebtor|add_class:'form-control' }}
          <span class="help-block">{{ form.yfcaseDebtor.error }}</span>
        </div>
        
        <!--債權人-->
        <div class="form-group">
          <label for="{{ form.yfcaseCreditor.id_for_label }}">
            {{ form.yfcaseCreditor.label }}
            </label>
          {{ form.yfcaseCreditor|add_class:'form-control' }}
          <span class="help-block">{{ form.yfcaseCreditor.error }}</span>
        </div>
        
			</div>
			<!-- footer -->
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary col" data-dismiss="modal">返回</button>
				<input class="btn btn-primary col-md-3" type="submit" value="更新" />
			</div>
		</div>
	</div>
</form>
{% block javascript %}
<script>
$(document).ready(function() {
  /* global $*/
  // 在載入時先disable掉yfcaseTownship欄位的功能
	document.getElementById('id_yfcaseTownship').disabled=true;
	$('#yfcaseUpdateForm').bootstrapValidator({
		// To use feedback icons, ensure that you use Bootstrap v3.1.0 or later
		feedbackIcons: {
			valid: 'glyphicon glyphicon-ok',
			invalid: 'glyphicon glyphicon-remove',
			validating: 'glyphicon glyphicon-refresh'
		},
		fields: {
			yfcaseCaseNumber: {
				validators: {
					notEmpty: {
						message: '此一欄位不得為空'
					},
					stringLength: {
						min: 5,
						max: 50,
						message: '案件名稱必需介於5-50個文字'
					}
				}
			},
			yfcaseCity: {
				validators: {
					notEmpty: {
						message: '此為必要欄位'
					}
				}
			},
			yfcaseTownship: {
				validators: {
					notEmpty: {
						message: '此為必要欄位'
					}
				}
			},
			yfcaseOtherAddress: {
				validators: {
					notEmpty: {
						message: '此為必要欄位'
					}
				}
			},
			yfcaseCompany: {
				validators: {
					notEmpty: {
						message: '必選欄位'
					}
				}
			}
		}
	});

});

// JS觸發事件來使yfcaseCity/yfcaseTownship這兩個欄位動作
$("#id_yfcaseCity").click(function() {
	var url = $("#yfcaseUpdateForm").attr("data-townships-url");
	var cityId = $(this).val();

	$.ajax({
		url: url,
		data: {
			'city': cityId
		},
		success: function(data) {
		  // 再解除document.getElementById('id_yfcaseTownship').disabled=true;的部份
	    $("#id_yfcaseTownship").removeAttr("disabled");
			$("#id_yfcaseTownship").html(data);
		}
	});
});
</script>
{% endblock javascript %}